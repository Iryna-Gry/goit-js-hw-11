{"mappings":"0lBASA,MAEMA,EAAeC,SAASC,cAAc,eACtCC,EAAUF,SAASG,eAAe,eAExC,IAAIC,EAAO,EAEPC,EAAa,EACbC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAChDC,aAAc,MAEZC,EAAY,EAChB,MAAMC,EAAS,CACbC,EAAG,GACHC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,KAAM,GACNC,SAZY,IA8BdC,eAAeC,EAAaC,GAE1B,GADAC,QAAQC,IAAIZ,GACM,IAAdA,EAIJ,IACE,MAAMa,QAAiB,EAAAC,EAAAC,SAAYL,GACnC,OAAwB,MAApBG,EAASG,OACJC,EAAAC,OAAOC,QACZ,6EAGJxB,EAAayB,KAAKC,KAAKR,EAASS,KAAKC,UA3C3B,UAwDdf,eAA4BK,GAE1B,GADAxB,EAAamC,mBAAmB,kBAAmB,EAAAC,EAAAV,SAAaF,IAC5C,IAAhBZ,EAAOK,KACT,OAAOW,EAAAC,OAAOQ,QACZ,qBAAqBb,EAASS,KAAKC,mB,CAhB/BI,CAAad,GACZ,C,KAAES,M,CACT,MAAOM,GACP,GAAqB,MAAjBA,EAAMZ,OAKR,OAJAC,EAAAC,OAAOC,QACL,iFAEF9B,EAAawC,UAAY,G,MAlB3BZ,EAAAC,OAAOY,KAAK,6D,CAnBhB,IAAIjC,EAAAkC,GAAJ,CAAezC,SAAS0C,iBAAkB,CACxCC,QAAS,KAgDXzC,EAAQ0C,iBAAiB,UA9CzB1B,eAAiC2B,GAC/BA,EAAIC,iBACJ/C,EAAawC,UAAY,GACzBnC,EAAO,EACPO,EAAOK,KAAOZ,EACdO,EAAOC,EAAIiC,EAAIE,cAAcC,SAASC,YAAYC,MAAMC,OACvC,KAAbxC,EAAOC,UAGLO,EAAaR,GAkDnBL,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAC5CC,aAAc,MAjDhBP,EAAQkD,Q,IAoCVC,OAAOT,iBAAiB,UAAU1B,UAE9BmC,OAAOC,QAAUD,OAAOE,aACxBvD,SAASwD,gBAAgBC,eAEzB9C,EAAOK,MAAQ,EACfN,EAAYL,EAAaM,EAAOK,KAAO,QACjCG,EAAaR,GACnBL,EAAQoD,QAAQ,uB","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport fetchImages from './fetchImages.js';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport createMarkup from './create-markup';\nimport OnlyScroll from 'only-scrollbar';\n\n// import InfiniteScroll from 'infinite-scroll';\nconst DEBOUNCE_DELAY = 300;\n// const inputRef = document.getElementById('search-box');\nconst imageListRef = document.querySelector('div.gallery');\nconst formRef = document.getElementById('search-form');\n\nlet page = 1;\nlet perPage = 40;\nlet totalPages = 1;\nlet gallery = new SimpleLightbox('.photo-card a', {\n  captionDelay: 250,\n});\nlet pagesLeft = 1;\nconst params = {\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: '',\n  per_page: perPage,\n};\nnew OnlyScroll(document.scrollingElement, {\n  damping: 0.6,\n});\nasync function invokeResponseSet(evt) {\n  evt.preventDefault();\n  imageListRef.innerHTML = '';\n  page = 1;\n  params.page = page;\n  params.q = evt.currentTarget.elements.searchQuery.value.trim();\n  if (params.q === '') {\n    return;\n  }\n  await renderImages(params);\n  createSimpleLightBox();\n  formRef.reset();\n}\nasync function renderImages(params) {\n  console.log(pagesLeft);\n  if (pagesLeft === 0) {\n    Notify.info(\"We're sorry, but you've reached the end of search results.\");\n    return;\n  }\n  try {\n    const response = await fetchImages(params);\n    if (response.status !== 200) {\n      return Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    }\n    totalPages = Math.ceil(response.data.totalHits / perPage);\n    await appendMarkup(response);\n    return { data };\n  } catch (error) {\n    if (error.status === 404) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      imageListRef.innerHTML = '';\n      return;\n    }\n  }\n}\nasync function appendMarkup(response) {\n  imageListRef.insertAdjacentHTML('beforeend', await createMarkup(response));\n  if (params.page === 1)\n    return Notify.success(\n      `Hoorray! We found ${response.data.totalHits} images`\n    );\n}\nformRef.addEventListener('submit', invokeResponseSet);\nwindow.addEventListener('scroll', async () => {\n  if (\n    window.scrollY + window.innerHeight >=\n    document.documentElement.scrollHeight\n  ) {\n    params.page += 1;\n    pagesLeft = totalPages - params.page + 1;\n    await renderImages(params);\n    gallery.refresh('show.simplelightbox');\n  }\n});\nfunction createSimpleLightBox() {\n  gallery = new SimpleLightbox('.photo-card a', {\n    captionDelay: 250,\n  });\n}\n"],"names":["$7f13665ecc617d63$var$imageListRef","document","querySelector","$7f13665ecc617d63$var$formRef","getElementById","$7f13665ecc617d63$var$page","$7f13665ecc617d63$var$totalPages","$7f13665ecc617d63$var$gallery","$parcel$interopDefault","$fZKcF","captionDelay","$7f13665ecc617d63$var$pagesLeft","$7f13665ecc617d63$var$params","q","image_type","orientation","safesearch","page","per_page","async","$7f13665ecc617d63$var$renderImages","params1","console","log","response","$ak5AJ","default","status","$iQIUW","Notify","failure","Math","ceil","data","totalHits","insertAdjacentHTML","$k0Ust","success","$7f13665ecc617d63$var$appendMarkup","error","innerHTML","info","$aKQqr","scrollingElement","damping","addEventListener","evt","preventDefault","currentTarget","elements","searchQuery","value","trim","reset","window","scrollY","innerHeight","documentElement","scrollHeight","refresh"],"version":3,"file":"infinite-scroll.10118eed.js.map"}