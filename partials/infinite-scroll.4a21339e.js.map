{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,8EAWMC,EAAeC,SAASC,cAAc,eACtCC,EAAUF,SAASG,eAAe,eAEpCC,EAAO,EAEPC,EAAa,EACbC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAChDC,aAAc,MAEZC,EAAY,EACVC,EAAS,CACbC,EAAG,GACHC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,KAAM,GACNC,SAZY,I,SAiBCC,I,OAAAA,EAAfX,EAAAV,EAAA,CAAAU,EAAAY,GAAAC,MAAA,SAAAC,EAAiCC,G,qEAC/BA,EAAIC,iBACJxB,EAAayB,UAAY,GACzBpB,EAAO,EACPO,EAAOK,KAAOZ,EACdO,EAAOC,EAAIU,EAAIG,cAAcC,SAASC,YAAYC,MAAMC,OACvC,KAAblB,EAAOC,EAAQ,C,gEAGbkB,EAAanB,G,OACnBoB,IACA7B,EAAQ8B,Q,6CAXsBC,MAAAC,KAAAC,U,UAajBL,EAAaM,G,OAAbC,EAAYJ,MAAAC,KAAAC,U,UAAZE,I,OAAAA,EAAf9B,EAAAV,EAAA,CAAAU,EAAAY,GAAAC,MAAA,SAAAC,EAA4Be,G,IAOlBE,E,qEANRC,QAAQC,IAAI9B,GACM,IAAdA,EAAe,C,sBACjB+B,EAAAC,OAAOC,KAAK,8D,oDAIW,EAAAC,EAAAC,SAAYT,G,UACX,OADlBE,EAAQQ,EAAAC,MACDC,OAAc,C,yCAClBP,EAAAC,OAAOO,QACZ,6E,eAGJ5C,EAAa6C,KAAKC,KAAKb,EAASc,KAAKC,UA3C3B,I,UA4CJC,EAAahB,G,iCACZ,CAAEc,Y,qCAEY,MAAjBN,EAAAS,GAAMP,OAAc,C,uBACtBP,EAAAC,OAAOO,QACL,4EAEFlD,EAAayB,UAAY,G,8EArBJS,MAAAC,KAAAC,U,UA0BZmB,EAAahB,G,OAAbkB,EAAYvB,MAAAC,KAAAC,U,UAAZqB,I,OAAAA,EAAfjD,EAAAV,EAAA,CAAAU,EAAAY,GAAAC,MAAA,SAAAC,EAA4BiB,G,8EAC1BvC,E,UAAmD,EAAA0D,EAAAZ,SAAaP,G,sBAAhEQ,EAAAS,GAAaG,mBAAkBC,KAAAb,EAAAS,GAAC,YAAWT,EAAAc,IACvB,IAAhBjD,EAAOK,KAAU,C,wCACZyB,EAAAC,OAAOmB,QACZ,qBAA6CC,OAAxBxB,EAASc,KAAKC,UAAU,a,4CAJxBpB,MAAAC,KAAAC,U,CAmB3B,SAASJ,IACPzB,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAC5CC,aAAc,K,CA/DlB,IAAIF,EAAAwD,GAAJ,CAAe/D,SAASgE,iBAAkB,CACxCC,QAAS,KAgDX/D,EAAQgE,iBAAiB,U,SA9CQ5C,G,OAAlBJ,EAAiBe,MAAAC,KAAAC,U,IA+ChCgC,OAAOD,iBAAiB,SAAU3D,EAAAV,EAAA,CAAAU,EAAAY,GAAAC,MAAA,SAAAC,I,uEAE9B8C,OAAOC,QAAUD,OAAOE,aACxBrE,SAASsE,gBAAgBC,cAAY,C,sBAErC5D,EAAOK,MAAQ,EACfN,EAAYL,EAAaM,EAAOK,KAAO,E,SACjCc,EAAanB,G,OACnBL,EAAQkE,QAAQ,uB","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport fetchImages from './fetchImages.js';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport createMarkup from './create-markup';\nimport OnlyScroll from 'only-scrollbar';\n\n// import InfiniteScroll from 'infinite-scroll';\nconst DEBOUNCE_DELAY = 300;\n// const inputRef = document.getElementById('search-box');\nconst imageListRef = document.querySelector('div.gallery');\nconst formRef = document.getElementById('search-form');\n\nlet page = 1;\nlet perPage = 40;\nlet totalPages = 1;\nlet gallery = new SimpleLightbox('.photo-card a', {\n  captionDelay: 250,\n});\nlet pagesLeft = 1;\nconst params = {\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: '',\n  per_page: perPage,\n};\nnew OnlyScroll(document.scrollingElement, {\n  damping: 0.6,\n});\nasync function invokeResponseSet(evt) {\n  evt.preventDefault();\n  imageListRef.innerHTML = '';\n  page = 1;\n  params.page = page;\n  params.q = evt.currentTarget.elements.searchQuery.value.trim();\n  if (params.q === '') {\n    return;\n  }\n  await renderImages(params);\n  createSimpleLightBox();\n  formRef.reset();\n}\nasync function renderImages(params) {\n  console.log(pagesLeft);\n  if (pagesLeft === 0) {\n    Notify.info(\"We're sorry, but you've reached the end of search results.\");\n    return;\n  }\n  try {\n    const response = await fetchImages(params);\n    if (response.status !== 200) {\n      return Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    }\n    totalPages = Math.ceil(response.data.totalHits / perPage);\n    await appendMarkup(response);\n    return { data };\n  } catch (error) {\n    if (error.status === 404) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      imageListRef.innerHTML = '';\n      return;\n    }\n  }\n}\nasync function appendMarkup(response) {\n  imageListRef.insertAdjacentHTML('beforeend', await createMarkup(response));\n  if (params.page === 1)\n    return Notify.success(\n      `Hoorray! We found ${response.data.totalHits} images`\n    );\n}\nformRef.addEventListener('submit', invokeResponseSet);\nwindow.addEventListener('scroll', async () => {\n  if (\n    window.scrollY + window.innerHeight >=\n    document.documentElement.scrollHeight\n  ) {\n    params.page += 1;\n    pagesLeft = totalPages - params.page + 1;\n    await renderImages(params);\n    gallery.refresh('show.simplelightbox');\n  }\n});\nfunction createSimpleLightBox() {\n  gallery = new SimpleLightbox('.photo-card a', {\n    captionDelay: 250,\n  });\n}\n"],"names":["$bpxeT","parcelRequire","$93b54f497d416715$var$imageListRef","document","querySelector","$93b54f497d416715$var$formRef","getElementById","$93b54f497d416715$var$page","$93b54f497d416715$var$totalPages","$93b54f497d416715$var$gallery","$parcel$interopDefault","$5IjG7","captionDelay","$93b54f497d416715$var$pagesLeft","$93b54f497d416715$var$params","q","image_type","orientation","safesearch","page","per_page","$93b54f497d416715$var$_invokeResponseSet","$2TvXO","mark","_callee","evt","preventDefault","innerHTML","currentTarget","elements","searchQuery","value","trim","$93b54f497d416715$var$renderImages","$93b54f497d416715$var$createSimpleLightBox","reset","apply","this","arguments","params1","$93b54f497d416715$var$_renderImages","response","console","log","$h6c0i","Notify","info","$iwbpK","default","_ctx","sent","status","failure","Math","ceil","data","totalHits","$93b54f497d416715$var$appendMarkup","t0","$93b54f497d416715$var$_appendMarkup","$dI30Z","insertAdjacentHTML","call","t1","success","concat","$1cIlU","scrollingElement","damping","addEventListener","window","scrollY","innerHeight","documentElement","scrollHeight","refresh"],"version":3,"file":"infinite-scroll.4a21339e.js.map"}