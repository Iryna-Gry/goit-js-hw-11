{"mappings":"0lBAOA,MAEMA,EAAeC,SAASC,cAAc,eACtCC,EAAUF,SAASG,eAAe,eAClCC,EAAcJ,SAASC,cAAc,cACrCI,EAAmBL,SAASC,cAAc,wBAEhDG,EAAYE,QAAS,EACrB,IAAIC,EAAO,EAEPC,EAAa,EACbC,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAChDC,aAAc,MAEZC,EAAY,EAChB,MAAMC,EAAS,CACbC,EAAG,GACHC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,KAAM,GACNC,SAZY,IA4BdC,eAAeC,EAAaC,GAE1B,GADAC,QAAQC,IAAIZ,GACM,IAAdA,EAGF,OAFAR,EAAiBqB,UAAY,QAC7BC,EAAAC,OAAOC,KAAK,8DAGd,IACE,MAAMC,QAAiB,EAAAC,EAAAC,SAAYT,GAEnC,OAAwB,MAApBO,EAASG,QACX7B,EAAYE,QAAS,EACdqB,EAAAC,OAAOM,QACZ,8EAGJ1B,EAAa2B,KAAKC,KAAKN,EAASO,KAAKC,UA5C3B,IA6CVlC,EAAYE,QAAS,QAiBzBe,eAA4BS,GAE1B,GADA/B,EAAawC,mBAAmB,kBAAmB,EAAAC,EAAAR,SAAaF,IAC5C,IAAhBhB,EAAOK,KACT,OAAOQ,EAAAC,OAAOa,QACZ,qBAAqBX,EAASO,KAAKC,mB,CApB/BI,CAAaZ,GACZ,C,KAAEO,M,CACT,MAAOM,GACP,GAAqB,MAAjBA,EAAMV,OAMR,OALA7B,EAAYE,QAAS,EACrBqB,EAAAC,OAAOM,QACL,iFAEFnC,EAAa2B,UAAY,G,EAK/B,IAAIhB,EAAAkC,GAAJ,CAAe5C,SAAS6C,iBAAkB,CACxCC,QAAS,KASX5C,EAAQ6C,iBAAiB,UAvDzB1B,eAAiC2B,GAC/BA,EAAIC,iBACJlD,EAAa2B,UAAY,GACzBnB,EAAO,EACPO,EAAOK,KAAOZ,EACdO,EAAOC,EAAIiC,EAAIE,cAAcC,SAASC,YAAYC,MAAMC,OACvC,KAAbxC,EAAOC,SAILO,EAAaR,GAsDnBL,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,gBAAiB,CAC5CC,aAAc,MArDhBV,EAAQqD,SALNnD,EAAYE,QAAS,C,IAiDzBF,EAAY2C,iBAAiB,SAAS1B,UACpCP,EAAOK,MAAQ,EACfN,EAAYL,EAAaM,EAAOK,KAAO,QACjCG,EAAaR,GACnBL,EAAQ+C,QAAQ,sBAAsB","sources":["src/js/btn-scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport fetchImages from './fetchImages.js';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport createMarkup from './create-markup';\nimport OnlyScroll from 'only-scrollbar';\nconst DEBOUNCE_DELAY = 300;\n// const inputRef = document.getElementById('search-box');\nconst imageListRef = document.querySelector('div.gallery');\nconst formRef = document.getElementById('search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loadContainerRef = document.querySelector('div.button-container');\n\nloadMoreBtn.hidden = true;\nlet page = 1;\nlet perPage = 40;\nlet totalPages = 1;\nlet gallery = new SimpleLightbox('.photo-card a', {\n  captionDelay: 250,\n});\nlet pagesLeft = 1;\nconst params = {\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: '',\n  per_page: perPage,\n};\nasync function invokeResponseSet(evt) {\n  evt.preventDefault();\n  imageListRef.innerHTML = '';\n  page = 1;\n  params.page = page;\n  params.q = evt.currentTarget.elements.searchQuery.value.trim();\n  if (params.q === '') {\n    loadMoreBtn.hidden = true;\n    return;\n  }\n  await renderImages(params);\n  createSimpleLightBox();\n  formRef.reset();\n}\nasync function renderImages(params) {\n  console.log(pagesLeft);\n  if (pagesLeft === 0) {\n    loadContainerRef.innerHTML = '';\n    Notify.info(\"We're sorry, but you've reached the end of search results.\");\n    return;\n  }\n  try {\n    const response = await fetchImages(params);\n\n    if (response.status !== 200) {\n      loadMoreBtn.hidden = true;\n      return Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    }\n    totalPages = Math.ceil(response.data.totalHits / perPage);\n    loadMoreBtn.hidden = false;\n    await appendMarkup(response);\n    return { data };\n  } catch (error) {\n    if (error.status === 404) {\n      loadMoreBtn.hidden = true;\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      imageListRef.innerHTML = '';\n      return;\n    }\n  }\n}\nnew OnlyScroll(document.scrollingElement, {\n  damping: 0.6,\n});\nasync function appendMarkup(response) {\n  imageListRef.insertAdjacentHTML('beforeend', await createMarkup(response));\n  if (params.page === 1)\n    return Notify.success(\n      `Hoorray! We found ${response.data.totalHits} images`\n    );\n}\nformRef.addEventListener('submit', invokeResponseSet);\nloadMoreBtn.addEventListener('click', async () => {\n  params.page += 1;\n  pagesLeft = totalPages - params.page + 1;\n  await renderImages(params);\n  gallery.refresh('show.simplelightbox');\n});\n\nfunction createSimpleLightBox() {\n  gallery = new SimpleLightbox('.photo-card a', {\n    captionDelay: 250,\n  });\n}\n"],"names":["$e6302add711f71af$var$imageListRef","document","querySelector","$e6302add711f71af$var$formRef","getElementById","$e6302add711f71af$var$loadMoreBtn","$e6302add711f71af$var$loadContainerRef","hidden","$e6302add711f71af$var$page","$e6302add711f71af$var$totalPages","$e6302add711f71af$var$gallery","$parcel$interopDefault","$fZKcF","captionDelay","$e6302add711f71af$var$pagesLeft","$e6302add711f71af$var$params","q","image_type","orientation","safesearch","page","per_page","async","$e6302add711f71af$var$renderImages","params1","console","log","innerHTML","$iQIUW","Notify","info","response","$ak5AJ","default","status","failure","Math","ceil","data","totalHits","insertAdjacentHTML","$k0Ust","success","$e6302add711f71af$var$appendMarkup","error","$aKQqr","scrollingElement","damping","addEventListener","evt","preventDefault","currentTarget","elements","searchQuery","value","trim","reset","refresh"],"version":3,"file":"btn-scroll.84ef08a7.js.map"}